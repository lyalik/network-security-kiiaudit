#!/bin/bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ ~/day2-lab.sh

echo "=== –õ–∞–±–∞ –î–Ω—è 2: –≠–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫–∏ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å L2 ==="
echo "–°—Ü–µ–Ω–∞—Ä–∏–π: –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤ –æ—Ñ–∏—Å–Ω–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ ARP-spoofing"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
if ! command -v arpspoof &> /dev/null; then
    echo "‚ö†Ô∏è  arpspoof –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ sudo)..."
    sudo apt update && sudo apt install -y dsniff
fi

echo -e "\n‚úÖ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã. –°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:"
echo "1. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ (192.168.20.20) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–ª—å—à–∏–≤—ã–µ ARP-–æ—Ç–≤–µ—Ç—ã:"
echo "   '–®–ª—é–∑ 192.168.20.1 –∏–º–µ–µ—Ç –º–æ–π MAC-–∞–¥—Ä–µ—Å'"
echo "2. –ñ–µ—Ä—Ç–≤–∞ (192.168.20.10) –æ–±–Ω–æ–≤–ª—è–µ—Ç ARP-—Ç–∞–±–ª–∏—Ü—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É"
echo "3. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ —à–ª—é–∑—É (–∞—Ç–∞–∫–∞ MITM)"

echo -e "\nüõ°Ô∏è  –ó–∞—â–∏—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –ö–ò–ò:"
echo "- DHCP Snooping: –¥–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º—É DHCP-—Å–µ—Ä–≤–µ—Ä—É"
echo "- DAI: –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ ARP-–ø–∞–∫–µ—Ç—ã –ø—Ä–æ—Ç–∏–≤ —Ç–∞–±–ª–∏—Ü—ã DHCP Snooping"
echo "- Port Security: —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ 1 MAC-–∞–¥—Ä–µ—Å –Ω–∞ –ø–æ—Ä—Ç —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏"

echo -e "\nüîç –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ ‚Äî –∞—Ç–∞–∫–∞ –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è):"
echo "–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∞—Ç–∞–∫–∏ (–≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö):"
echo "  arpspoof -i eth0 -t 192.168.20.10 192.168.20.1"
echo ""
echo "–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã (–Ω–∞ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–µ):"
echo "  ip dhcp snooping"
echo "  ip arp inspection vlan 20"
echo "  switchport port-security maximum 1"
echo "  switchport port-security violation shutdown"

echo -e "\n‚úÖ –í—ã–≤–æ–¥: –ë–µ–∑ –∑–∞—â–∏—Ç—ã —É—Ä–æ–≤–Ω—è L2 —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ö–ò–ò –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞ ‚Äî –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ–±—Ö–æ–¥–∏—Ç –≥—Ä–∞–Ω–∏—Ü—ã —á–µ—Ä–µ–∑ –∞—Ç–∞–∫—É –Ω–∞ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä."